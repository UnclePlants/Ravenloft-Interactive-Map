<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Castle Ravenloft</title>

<style>
body {
  margin: 0;
  display: flex;
  height: 100vh;
}

/* LEFT SIDE — SCROLLABLE MAP */
#map-wrapper {
  width: 70%;
  height: 100vh;
  overflow-y: auto;
  background: #111;
}

#map-inner {
  position: relative;
  width: 100%;
}

#map-inner img {
  width: 100%;
  height: auto;
  display: block;
}

/* RIGHT SIDE — FIXED INFO PANEL */
#info {
  width: 30%;
  height: 100vh;
  overflow-y: auto;
  background: #222;
  color: white;
  padding: 15px;

}


.room {
  position: absolute;

  width: 2vw;
  height: 1.5vw;

  background: black;
  color: white;
  border: 1px solid white;
  border-radius: 999px; /* better for oval pills */

  font-size: 0.7vw;
  cursor: pointer;

  display: flex;
  align-items: center;      /* vertical center */
  justify-content: center;  /* horizontal center */
}
.player-text {
  background: #0f1a2b;
  border: 1px solid #2a3f66;
  padding: 12px;
  border-radius: 4px;
  color: #cfe4ff;

}
.section-title {
  margin-top: 18px;
  margin-bottom: 8px;
  font-weight: bold;
  font-size: 15px;
  letter-spacing: 1px;
  color: #cccccc;
  border-top: 1px solid #555;
  padding-top: 6px;
}


.dm-text {
  color: white;     /* standard DM notes */
  padding: 12px;
  padding-bottom: 12px;

}
.section-title {
  margin-top: 18px;
  margin-bottom: 8px;
  font-weight: bold;
  font-size: 15px;
  letter-spacing: 1px;
  color: #cccccc;
  border-top: 1px solid #555;
  padding-top: 6px;


}
.room.nav {
  width: 120px;           /* rectangle width */
  height: 28px;           /* rectangle height */
  border-radius: 4px;     /* slightly rounded corners */
  background: darkred;    /* different color from normal rooms */
  border: 2px solid white;
  color: white;
  font-size: 10px;
  line-height: 28px;      /* center text vertically */
  text-align: center;
  cursor: pointer;


}
#room-code {
  color:  #c65a00;
  font-weight: bold;
  letter-spacing: 1px;
  margin-right: 10px;
  text-shadow: 0 0 4px #400000;
}
#title-box {
  background: #181818;
  border: 1px solid #333;
  padding: 14px;
  margin-bottom: 18px;
  border-radius: 6px;

  display: flex;
  align-items: center;
  gap: 12px;
}

#title {
  font-size: 20px;
  font-weight: 600;
  color:  #c65a00;
}
.tombstone-text {
  background: linear-gradient(#3a3a3a, #2a2a2a);
  border: 2px solid #555;
  padding: 14px;
  margin: 18px 0;
  border-radius: 6px;

  font-family: "Georgia", serif;
  font-size: 14px;
  letter-spacing: 1px;
  text-align: center;

  color: #d6d2c4;

  box-shadow:
    inset 0 2px 4px rgba(0,0,0,0.8),
    0 2px 6px rgba(0,0,0,0.6);

  text-transform: uppercase;
}
#search-container {
  margin-bottom: 15px;
}

#search {
  width: 100%;
  padding: 8px 10px;
  background: #111;
  border: 1px solid #444;
  color: #eee;
  font-family: inherit;
  font-size: 14px;
  border-radius: 4px;
}

#search:focus {
  outline: none;
  border-color: #a06030;
}
#search {
  width: 100%;
  padding: 8px;
  margin-bottom: 8px;
  background: #111;
  color: white;
  border: 1px solid #555;
}

#search-results {
  max-height: 200px;
  overflow-y: auto;
  background: #1a1a1a;
  border: 1px solid #444;
  display: none;
}

.search-item {
  padding: 6px 8px;
  cursor: pointer;
}

.search-item:hover {
  background: darkred;
}

</style>
</head>

<body>

<div id="map-wrapper">
  <div id="map-inner">
    <img src="floor-2.webp">
 <!-- FLOOR -2 BUTTONS -->
<button class="room" style="top:16.83%; left:8.75%;" onclick="show('K79')">K79</button>
<button class="room" style="top:23.21%; left:12.35%;" onclick="show('K80')">K80</button>
<button class="room" style="top:33.37%; left:11.67%;" onclick="show('K78')">K78</button>
<button class="room" style="top:42.93%; left:11.96%;" onclick="show('K77')">K77</button>
<button class="room" style="top:55.98%; left:11.67%;" onclick="show('K76')">K76</button>
<button class="room" style="top:55.58%; left:27.71%;" onclick="show('K73')">K73</button>
<button class="room" style="top:39.34%; left:24.6%;" onclick="show('K74a')">K74a</button>
<button class="room" style="top:42.63%; left:24.5%;" onclick="show('K74b')">K74b</button>
<button class="room" style="top:45.92%; left:24.5%;" onclick="show('K74c')">K74c</button>
<button class="room" style="top:49%; left:24.6%;" onclick="show('K74d')">K74d</button>
<button class="room" style="top:39.44%; left:31.12%;" onclick="show('K74e')">K74e</button>
<button class="room" style="top:42.73%; left:31.21%;" onclick="show('K74f')">K74f</button>
<button class="room" style="top:45.82%; left:31.12%;" onclick="show('K74g')">K74g</button>
<button class="room" style="top:49.1%; left:31.12%;" onclick="show('K74h')">K74h</button>
<button class="room" style="top:31.97%; left:30.92%;" onclick="show('K82')">K82</button>
<button class="room" style="top:23.51%; left:34.23%;" onclick="show('K81')">K81</button>
<button class="room" style="top:23.41%; left:49.79%;" onclick="show('Crypt1')">1</button>
<button class="room" style="top:23.51%; left:52.9%;" onclick="show('Crypt2')">2</button>
<button class="room" style="top:23.61%; left:59.32%;" onclick="show('Crypt3')">3</button>
<button class="room" style="top:22.71%; left:65.54%;" onclick="show('Crypt4')">4</button>
<button class="room" style="top:23.21%; left:71.47%;" onclick="show('Crypt5')">5</button>
<button class="room" style="top:23.21%; left:81.68%;" onclick="show('Crypt6')">6</button>
<button class="room" style="top:29.78%; left:49.4%;" onclick="show('Crypt7')">7</button>
<button class="room" style="top:29.88%; left:56.01%;" onclick="show('Crypt8')">8</button>
<button class="room" style="top:29.48%; left:62.82%;" onclick="show('Crypt9')">9</button>
<button class="room" style="top:29.68%; left:68.56%;" onclick="show('Crypt10')">10</button>
<button class="room" style="top:29.48%; left:75.65%;" onclick="show('Crypt11')">11</button>
<button class="room" style="top:36.25%; left:81.68%;" onclick="show('Crypt17')">17</button>
<button class="room" style="top:36.06%; left:43.47%;" onclick="show('Crypt12')">12</button>
<button class="room" style="top:36.15%; left:52.8%;" onclick="show('Crypt13')">13</button>
<button class="room" style="top:35.96%; left:59.12%;" onclick="show('Crypt14')">14</button>
<button class="room" style="top:36.35%; left:65.54%;" onclick="show('Crypt15')">15</button>
<button class="room" style="top:36.15%; left:72.45%;" onclick="show('Crypt16')">16</button>
<button class="room" style="top:42.23%; left:56.21%;" onclick="show('Crypt18')">18</button>
<button class="room" style="top:42.23%; left:62.33%;" onclick="show('Crypt19')">19</button>
<button class="room" style="top:42.23%; left:68.85%;" onclick="show('Crypt20')">20</button>
<button class="room" style="top:52.69%; left:56.11%;" onclick="show('Crypt21')">21</button>
<button class="room" style="top:47.8%; left:62.53%;" onclick="show('K84')">K84</button>
<button class="room" style="top:52.49%; left:62.53%;" onclick="show('Crypt22')">22</button>
<button class="room" style="top:52.69%; left:68.85%;" onclick="show('Crypt23')">23</button>
<button class="room" style="top:59.06%; left:53.29%;" onclick="show('Crypt25')">25</button>
<button class="room" style="top:59.06%; left:59.32%;" onclick="show('Crypt26')">26</button>
<button class="room" style="top:58.37%; left:65.64%;" onclick="show('Crypt27')">27</button>
<button class="room" style="top:58.96%; left:72.35%;" onclick="show('Crypt28')">28</button>
<button class="room" style="top:58.86%; left:81.68%;" onclick="show('Crypt29')">29</button>
<button class="room" style="top:59.06%; left:43.66%;" onclick="show('Crypt24')">24</button>
<button class="room" style="top:65.64%; left:49.89%;" onclick="show('Crypt30')">30</button>
<button class="room" style="top:65.36%; left:55.72%;" onclick="show('Crypt31')">31</button>
<button class="room" style="top:65.46%; left:62.53%;" onclick="show('Crypt32')">32</button>
<button class="room" style="top:64.84%; left:68.85%;" onclick="show('Crypt33')">33</button>
<button class="room" style="top:65.14%; left:75.75%;" onclick="show('Crypt34')">34</button>
<button class="room" style="top:72.23%; left:52.8%;" onclick="show('Crypt36')">36</button>
<button class="room" style="top:72.11%; left:43.37%;" onclick="show('Crypt35')">35</button>
<button class="room" style="top:71.53%; left:59.61%;" onclick="show('Crypt37')">37</button>
<button class="room" style="top:72.13%; left:65.74%;" onclick="show('Crypt38')">38</button>
<button class="room" style="top:71.83%; left:71.57%;" onclick="show('Crypt39')">39</button>
<button class="room" style="top:71.81%; left:81.68%;" onclick="show('Crypt40')">40</button>
<button class="room" style="top:82.41%; left:65.74%;" onclick="show('K86')">K86</button>
<button class="room" style="top:10.56%; left:65.93%;" onclick="show('K85')">K85</button>
<button class="room" style="top:45.52%; left:92.96%;" onclick="show('K88')">K88</button>
<button class="room" style="top:47.11%; left:81.59%;" onclick="show('K87')">K87</button>
<button class="room" style="top:50.9%; left:45.02%;" onclick="show('K18a')">K18a</button>
<button class="room" style="top:46.11%; left:45.7%;" onclick="show('K18')">K18</button>
<button class="room" style="top:57.37%; left:38.41%;" onclick="show('K21')">K21</button>
<button class="room" style="top:62.05%; left:24.5%;" onclick="show('K75h')">K75h</button>
<button class="room" style="top:71.81%; left:30.83%;" onclick="show('K75a')">K75a</button>
<button class="room" style="top:68.53%; left:30.92%;" onclick="show('K75b')">K75b</button>
<button class="room" style="top:65.34%; left:30.83%;" onclick="show('K75c')">K75c</button>
<button class="room" style="top:62.05%; left:30.83%;" onclick="show('K75d')">K75d</button>
<button class="room" style="top:71.81%; left:24.41%;" onclick="show('K75e')">K75e</button>
<button class="room" style="top:68.62%; left:24.5%;" onclick="show('K75f')">K75f</button>
<button class="room" style="top:65.44%; left:24.6%;" onclick="show('K75g')">K75g</button>
<button class="room nav" style="top:0.5%; left:60%;" onclick="window.location.href='floor-1.html'">Go Upstairs</button>
</div>
</div>

<div id="info">

  <input id="search" placeholder="Search..." autocomplete="off">
  <div id="search-results"></div>

  <div id="title-box">
    <span id="room-code"></span>
    <span id="title"></span>
  </div>

  <div id="content">Click a number.</div>

</div>


<script src="rooms.js"></script>

<script>

// ======================
// ROOM DISPLAY FUNCTION
// ======================

function show(room) {

  const data = ROOMS[room];
  if (!data) return;

  const codeEl = document.getElementById("room-code");
  const titleEl = document.getElementById("title");
  const contentEl = document.getElementById("content");

  codeEl.innerText = room;
  titleEl.innerText = data.title;
  contentEl.innerHTML = "";

  data.sections.forEach(section => {

    const block = document.createElement("div");

    if (section.type === "read") {
      block.className = "player-text";
    } 
    else if (section.type === "subtitle") {
      block.className = "section-title";
    } 
    else if (section.type === "tombstone") {
  block.className = "tombstone-text";
    }
    else {
      block.className = "dm-text";
    }

    block.innerText = section.text.trim();
    contentEl.appendChild(block);

  });
}


// ======================
// SEARCH SYSTEM
// ======================

document.addEventListener("DOMContentLoaded", function () {

  const searchInput = document.getElementById("search");
  const resultsBox = document.getElementById("search-results");

  searchInput.addEventListener("input", function () {

    const query = this.value.toLowerCase().trim();
    resultsBox.innerHTML = "";

    if (!query) {
      resultsBox.style.display = "none";
      return;
    }

    let count = 0;
    const MAX_RESULTS = 20;

    for (const key in ROOMS) {

      if (count >= MAX_RESULTS) break;

      const room = ROOMS[key];

      let fullText = key + " " + room.title;

      room.sections.forEach(section => {
        if (section.text) {
          fullText += " " + section.text;
        }
      });

      if (fullText.toLowerCase().includes(query)) {

        const item = document.createElement("div");
        item.className = "search-item";
        item.innerText = `${key} — ${room.title}`;

        item.onclick = () => {
          show(key);
          resultsBox.style.display = "none";
          searchInput.value = "";
        };

        resultsBox.appendChild(item);
        count++;
      }
    }

    resultsBox.style.display =
      resultsBox.children.length ? "block" : "none";

  });

});
</script>


</body>
</html>
