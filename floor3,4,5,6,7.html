<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Castle Ravenloft</title>

<style>
body {
  margin: 0;
  display: flex;
  height: 100vh;
}

/* LEFT SIDE — SCROLLABLE MAP */
#map-wrapper {
  width: 70%;
  height: 100vh;
  overflow-y: auto;
  background: #111;
}

#map-inner {
  position: relative;
  width: 100%;
}

#map-inner img {
  width: 100%;
  height: auto;
  display: block;
}

/* RIGHT SIDE — FIXED INFO PANEL */
#info {
  width: 30%;
  height: 100vh;
  overflow-y: auto;
  background: #222;
  color: white;
  padding: 15px;

}


.room {
  position: absolute;

  width: 2vw;
  height: 1.5vw;

  background: black;
  color: white;
  border: 1px solid white;
  border-radius: 999px; /* better for oval pills */

  font-size: 0.7vw;
  cursor: pointer;

  display: flex;
  align-items: center;      /* vertical center */
  justify-content: center;  /* horizontal center */
}
.player-text {
  background: #0f1a2b;
  border: 1px solid #2a3f66;
  padding: 12px;
  border-radius: 4px;
  color: #cfe4ff;

}
.section-title {
  margin-top: 18px;
  margin-bottom: 8px;
  font-weight: bold;
  font-size: 15px;
  letter-spacing: 1px;
  color: #cccccc;
  border-top: 1px solid #555;
  padding-top: 6px;
}


.dm-text {
  color: white;     /* standard DM notes */
  padding: 12px;
  padding-bottom: 12px;

}
.section-title {
  margin-top: 18px;
  margin-bottom: 8px;
  font-weight: bold;
  font-size: 15px;
  letter-spacing: 1px;
  color: #cccccc;
  border-top: 1px solid #555;
  padding-top: 6px;


}
.room.nav {
  width: 120px;           /* rectangle width */
  height: 28px;           /* rectangle height */
  border-radius: 4px;     /* slightly rounded corners */
  background: darkred;    /* different color from normal rooms */
  border: 2px solid white;
  color: white;
  font-size: 10px;
  line-height: 28px;      /* center text vertically */
  text-align: center;
  cursor: pointer;


}
#room-code {
  color: #c65a00;
  font-weight: bold;
  letter-spacing: 1px;
  margin-right: 10px;
  text-shadow: 0 0 4px #400000;
}
#title-box {
  background: #181818;
  border: 1px solid #333;
  padding: 14px;
  margin-bottom: 18px;
  border-radius: 6px;

  display: flex;
  align-items: center;
  gap: 12px;
}

#title {
  font-size: 20px;
  font-weight: 600;
    color:  #c65a00;
}
}
#search-container {
  margin-bottom: 15px;
}

#search {
  width: 100%;
  padding: 8px 10px;
  background: #111;
  border: 1px solid #444;
  color: #eee;
  font-family: inherit;
  font-size: 14px;
  border-radius: 4px;
}

#search:focus {
  outline: none;
  border-color: #a06030;
}
#search {
  width: 100%;
  padding: 8px;
  margin-bottom: 8px;
  background: #111;
  color: white;
  border: 1px solid #555;
}

#search-results {
  max-height: 200px;
  overflow-y: auto;
  background: #1a1a1a;
  border: 1px solid #444;
  display: none;
}

.search-item {
  padding: 6px 8px;
  cursor: pointer;
}

.search-item:hover {
  background: darkred;
}
.tombstone-text {
  background: linear-gradient(#3a3a3a, #2a2a2a);
  border: 2px solid #555;
  padding: 14px;
  margin: 18px 0;
  border-radius: 6px;

  font-family: "Georgia", serif;
  font-size: 14px;
  letter-spacing: 1px;
  text-align: center;

  color: #d6d2c4;

  box-shadow:
    inset 0 2px 4px rgba(0,0,0,0.8),
    0 2px 6px rgba(0,0,0,0.6);

  text-transform: uppercase;
}
</style>
</head>

<body>

<div id="map-wrapper">
  <div id="map-inner">
    <img src="floor3,4,5,6,7.webp">
 <!-- FLOOR 3,4,5,6,7 BUTTONS -->
<button class="room" style="top:14.1%; left:14.51%;" onclick="show('K20')">K20</button>
<button class="room" style="top:32.42%; left:13.41%;" onclick="show('K48')">K48</button>
<button class="room" style="top:37.9%; left:12.15%;" onclick="show('K56')">K56</button>
<button class="room" style="top:37.59%; left:8.66%;" onclick="show('K54')">K54</button>
<button class="room" style="top:43.7%; left:12.89%;" onclick="show('K55')">K55</button>
<button class="room" style="top:23.49%; left:65.91%;" onclick="show('K20')">K20</button>
<button class="room" style="top:26%; left:48.59%;" onclick="show('K53')">K53</button>
<button class="room" style="top:37.9%; left:52.6%;" onclick="show('K53')">K53</button>
<button class="room" style="top:30.07%; left:20.91%;" onclick="show('K18')">K18</button>
<button class="room" style="top:34.93%; left:19.96%;" onclick="show('K18a')">K18a</button>
<button class="room" style="top:60.3%; left:15.21%;" onclick="show('K20')">K20</button>
<button class="room" style="top:73.92%; left:15.42%;" onclick="show('K58')">K58</button>
<button class="room" style="top:79.25%; left:20.91%;" onclick="show('K18')">K18</button>
<button class="room" style="top:83.63%; left:20.07%;" onclick="show('K18a')">K18a</button>
<button class="room" style="top:86.14%; left:11.51%;" onclick="show('K57')">K57</button>
<button class="room" style="top:88.18%; left:39.4%;" onclick="show('K60a')">K60a</button>
<button class="room" style="top:85.67%; left:50.59%;" onclick="show('K60')">K60</button>
<button class="room" style="top:86.14%; left:82.17%;" onclick="show('K59')">K59</button>
<button class="room" style="top:90.68%; left:82.07%;" onclick="show('K18a')">K18a</button>
<button class="room" style="top:93.5%; left:83.76%;" onclick="show('K18')">K18</button>
<button class="room" style="top:46.67%; left:60.2%;" onclick="show('K49')">K49</button>
<button class="room" style="top:48.86%; left:64.75%;" onclick="show('K21')">K21</button>
<button class="room" style="top:45.42%; left:64.32%;" onclick="show('K47')">K47</button>
<button class="room" style="top:54.35%; left:64.85%;" onclick="show('K50')">K50</button>
<button class="room" style="top:56.38%; left:70.87%;" onclick="show('K51')">K51</button>
<button class="room" style="top:39.94%; left:72.67%;" onclick="show('K18')">K18</button>
<button class="room" style="top:57.01%; left:80.48%;" onclick="show('K18a')">K18a</button>
<button class="room" style="top:29.91%; left:59.68%;" onclick="show('K52')">K52</button>
<button class="room" style="top:38.84%; left:64.75%;" onclick="show('K48')">K48</button>
<button class="room nav" style="top:0.5%; left:20%;" onclick="window.location.href='floor2.html'">Go Downstairs</button>
</div>
</div>

<div id="info">

  <input id="search" placeholder="Search..." autocomplete="off">
  <div id="search-results"></div>

  <div id="title-box">
    <span id="room-code"></span>
    <span id="title"></span>
  </div>

  <div id="content">Click a number.</div>

</div>


<script src="rooms.js"></script>

<script src="rooms.js"></script>

<script>

// ======================
// ROOM DISPLAY FUNCTION
// ======================

function show(room) {

  const data = ROOMS[room];
  if (!data) return;

  const codeEl = document.getElementById("room-code");
  const titleEl = document.getElementById("title");
  const contentEl = document.getElementById("content");

  codeEl.innerText = room;
  titleEl.innerText = data.title;
  contentEl.innerHTML = "";

  data.sections.forEach(section => {

    const block = document.createElement("div");

    if (section.type === "read") {
      block.className = "player-text";
    } 
    else if (section.type === "subtitle") {
      block.className = "section-title";
    } 
    else if (section.type === "tombstone") {
  block.className = "tombstone-text";
    }
    else {
      block.className = "dm-text";
    }

    block.innerText = section.text.trim();
    contentEl.appendChild(block);

  });
}


// ======================
// SEARCH SYSTEM
// ======================

document.addEventListener("DOMContentLoaded", function () {

  const searchInput = document.getElementById("search");
  const resultsBox = document.getElementById("search-results");

  searchInput.addEventListener("input", function () {

    const query = this.value.toLowerCase().trim();
    resultsBox.innerHTML = "";

    if (!query) {
      resultsBox.style.display = "none";
      return;
    }

    let count = 0;
    const MAX_RESULTS = 20;

    for (const key in ROOMS) {

      if (count >= MAX_RESULTS) break;

      const room = ROOMS[key];

      let fullText = key + " " + room.title;

      room.sections.forEach(section => {
        if (section.text) {
          fullText += " " + section.text;
        }
      });

      if (fullText.toLowerCase().includes(query)) {

        const item = document.createElement("div");
        item.className = "search-item";
        item.innerText = `${key} — ${room.title}`;

        item.onclick = () => {
          show(key);
          resultsBox.style.display = "none";
          searchInput.value = "";
        };

        resultsBox.appendChild(item);
        count++;
      }
    }

    resultsBox.style.display =
      resultsBox.children.length ? "block" : "none";

  });

});
</script>


</body>
</html>
