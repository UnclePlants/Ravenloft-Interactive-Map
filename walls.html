<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Castle Ravenloft</title>

<style>
body {
  margin: 0;
  display: flex;
  height: 100vh;
}

/* LEFT SIDE — SCROLLABLE MAP */
#map-wrapper {
  width: 70%;
  height: 100vh;
  overflow-y: auto;
  background: #111;
}

#map-inner {
  position: relative;
  width: 100%;
}

#map-inner img {
  width: 100%;
  height: auto;
  display: block;
}

/* RIGHT SIDE — FIXED INFO PANEL */
#info {
  width: 30%;
  height: 100vh;
  overflow-y: auto;
  background: #222;
  color: white;
  padding: 15px;

}
#room-code {
  color: #c65a00;
  font-weight: bold;
  letter-spacing: 1px;
  margin-right: 10px;
  text-shadow: 0 0 4px #400000;
}
#title-box {
  background: #181818;
  border: 1px solid #333;
  padding: 14px;
  margin-bottom: 18px;
  border-radius: 6px;

  display: flex;
  align-items: center;
  gap: 12px;
}

#title {
  font-size: 20px;
  font-weight: 600;
    color:  #c65a00;
}




.room {
  position: absolute;

  width: 2vw;
  height: 1.5vw;

  background: black;
  color: white;
  border: 1px solid white;
  border-radius: 999px; /* better for oval pills */

  font-size: 0.7vw;
  cursor: pointer;

  display: flex;
  align-items: center;      /* vertical center */
  justify-content: center;  /* horizontal center */
}
.player-text {
  background: #0f1a2b;
  border: 1px solid #2a3f66;
  padding: 12px;
  border-radius: 4px;
  color: #cfe4ff;

}
.section-title {
  margin-top: 18px;
  margin-bottom: 8px;
  font-weight: bold;
  font-size: 15px;
  letter-spacing: 1px;
  color: #cccccc;
  border-top: 1px solid #555;
  padding-top: 6px;
}


.dm-text {
  color: white;     /* standard DM notes */
  padding: 12px;
  padding-bottom: 12px;

}
.section-title {
  margin-top: 18px;
  margin-bottom: 8px;
  font-weight: bold;
  font-size: 15px;
  letter-spacing: 1px;
  color: #cccccc;
  border-top: 1px solid #555;
  padding-top: 6px;


}
.room.nav {
  width: 120px;           /* rectangle width */
  height: 28px;           /* rectangle height */
  border-radius: 4px;     /* slightly rounded corners */
  background: darkred;    /* different color from normal rooms */
  border: 2px solid white;
  color: white;
  font-size: 10px;
  line-height: 28px;      /* center text vertically */
  text-align: center;
  cursor: pointer;


}
#search-container {
  margin-bottom: 15px;
}

#search {
  width: 100%;
  padding: 8px 10px;
  background: #111;
  border: 1px solid #444;
  color: #eee;
  font-family: inherit;
  font-size: 14px;
  border-radius: 4px;
}

#search:focus {
  outline: none;
  border-color: #a06030;
}
#search {
  width: 100%;
  padding: 8px;
  margin-bottom: 8px;
  background: #111;
  color: white;
  border: 1px solid #555;
}

#search-results {
  max-height: 200px;
  overflow-y: auto;
  background: #1a1a1a;
  border: 1px solid #444;
  display: none;
}

.search-item {
  padding: 6px 8px;
  cursor: pointer;
}

.search-item:hover {
  background: darkred;
}
.tombstone-text {
  background: linear-gradient(#3a3a3a, #2a2a2a);
  border: 2px solid #555;
  padding: 14px;
  margin: 18px 0;
  border-radius: 6px;

  font-family: "Georgia", serif;
  font-size: 14px;
  letter-spacing: 1px;
  text-align: center;

  color: #d6d2c4;

  box-shadow:
    inset 0 2px 4px rgba(0,0,0,0.8),
    0 2px 6px rgba(0,0,0,0.6);

  text-transform: uppercase;
}

</style>
</head>

<body>

<div id="map-wrapper">
  <div id="map-inner">
    <img src="walls.webp">
 <!-- WALLS BUTTONS -->
<button class="room" style="top:93.18%; left:48.75%;" onclick="show('J')">J</button>
<button class="room" style="top:66.28%; left:48.62%;" onclick="show('K1')">K1</button>
<button class="room" style="top:49.27%; left:74.58%;" onclick="show('K2')">K2</button>
<button class="room" style="top:49.34%; left:22.27%;" onclick="show('K2')">K2</button>
<button class="room" style="top:32.89%; left:35.1%;" onclick="show('K3')">K3</button>
<button class="room" style="top:25.87%; left:20.13%;" onclick="show('K4')">K4</button>
<button class="room" style="top:21.49%; left:48.75%;" onclick="show('K5')">K5</button>
<button class="room" style="top:6.95%; left:48.52%;" onclick="show('K6')">K6</button>
<button class="room nav" style="top:0.5%; left:44.0%;" onclick="window.location.href='floor0.html'">Enter Castle</button>
</div>
</div>

<div id="info">

  <input id="search" placeholder="Search..." autocomplete="off">
  <div id="search-results"></div>

  <div id="title-box">
    <span id="room-code"></span>
    <span id="title"></span>
  </div>

  <div id="content">Click a number.</div>

</div>


<script src="rooms.js"></script>

<script>

// ======================
// ROOM DISPLAY FUNCTION
// ======================

function show(room) {

  const data = ROOMS[room];
  if (!data) return;

  const codeEl = document.getElementById("room-code");
  const titleEl = document.getElementById("title");
  const contentEl = document.getElementById("content");

  codeEl.innerText = room;
  titleEl.innerText = data.title;
  contentEl.innerHTML = "";

  data.sections.forEach(section => {

    const block = document.createElement("div");

    if (section.type === "read") {
      block.className = "player-text";
    } 
    else if (section.type === "subtitle") {
      block.className = "section-title";
    } 
    else if (section.type === "tombstone") {
  block.className = "tombstone-text";
    }
    else {
      block.className = "dm-text";
    }

    block.innerText = section.text.trim();
    contentEl.appendChild(block);

  });
}


// ======================
// SEARCH SYSTEM
// ======================

document.addEventListener("DOMContentLoaded", function () {

  const searchInput = document.getElementById("search");
  const resultsBox = document.getElementById("search-results");

  searchInput.addEventListener("input", function () {

    const query = this.value.toLowerCase().trim();
    resultsBox.innerHTML = "";

    if (!query) {
      resultsBox.style.display = "none";
      return;
    }

    let count = 0;
    const MAX_RESULTS = 20;

    for (const key in ROOMS) {

      if (count >= MAX_RESULTS) break;

      const room = ROOMS[key];

      let fullText = key + " " + room.title;

      room.sections.forEach(section => {
        if (section.text) {
          fullText += " " + section.text;
        }
      });

      if (fullText.toLowerCase().includes(query)) {

        const item = document.createElement("div");
        item.className = "search-item";
        item.innerText = `${key} — ${room.title}`;

        item.onclick = () => {
          show(key);
          resultsBox.style.display = "none";
          searchInput.value = "";
        };

        resultsBox.appendChild(item);
        count++;
      }
    }

    resultsBox.style.display =
      resultsBox.children.length ? "block" : "none";

  });

});
</script>


</body>
</html>
